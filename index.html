<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Daily Task Submission</title>
  <style>
    body {
      background: #f6f7fb;
      font-family: 'Inter', Arial, sans-serif;
      margin: 0;
      padding: 30px 0;
    }
    .container {
      max-width: 600px;
      margin: 40px auto;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 4px 32px rgba(80, 105, 138, 0.10);
      padding: 40px 36px 32px 36px;
    }
    h1 {
      margin: 0 0 8px 0;
      font-size: 2.3rem;
      font-weight: 700;
      color: #151a21;
      letter-spacing: -1px;
    }
    .instructions {
      font-size: 1rem;
      color: #4f5563;
      margin-bottom: 32px;
      line-height: 1.5;
    }
    .question-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }
    .question-header label {
      font-weight: 600;
      color: #23272f;
      margin: 0;
      letter-spacing: -0.01em;
      flex: 1;
    }
    .question-header input[type="checkbox"] {
      accent-color: #5970f7;
      width: 18px;
      height: 18px;
      flex-shrink: 0;
    }
    .question {
      margin-bottom: 20px;
    }
    .desc {
      font-size: 0.98rem;
      color: #697089;
      margin-bottom: 4px;
      font-weight: 400;
    }
    textarea {
      width: 100%;
      min-height: 70px;
      padding: 12px;
      border: 1px solid #e3e8ef;
      border-radius: 10px;
      font-size: 1rem;
      margin-top: 4px;
      margin-bottom: 8px;
      resize: vertical;
      background: #fafbfc;
      transition: border .2s;
      box-sizing: border-box;
    }
    textarea:focus {
      border: 1.5px solid #5970f7;
      outline: none;
      background: #fff;
    }
    textarea.error-field {
      border: 1.5px solid #e13b2e;
      background: #fef5f5;
    }
    .char-counter {
      font-size: 0.85rem;
      color: #b5bac3;
      text-align: right;
      margin-bottom: 0;
    }
    .radio-group {
      margin-bottom: 10px;
      margin-left: 30px;
    }
    .radio-group label {
      font-weight: 400;
      margin-right: 16px;
      display: inline-block;
      color: #23272f;
    }
    .radio-group input[type="radio"] {
      margin-right: 8px;
      accent-color: #5970f7;
    }
    .form-section {
      margin-bottom: 26px;
    }
    button[type="submit"] {
      background: #5970f7;
      color: #fff;
      border: none;
      font-size: 1.08rem;
      font-weight: 700;
      border-radius: 8px;
      padding: 14px 32px;
      margin-top: 16px;
      cursor: pointer;
      transition: background 0.18s;
      letter-spacing: 0.04em;
      box-shadow: 0 2px 6px 0 rgba(80, 105, 138, 0.06);
    }
    button[type="submit"]:hover:not(:disabled) {
      background: #4150c1;
    }
    button[type="submit"]:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }
    .textarea-container {
      display: none;
      margin-left: 30px;
    }
    .textarea-container.show {
      display: block;
    }
    .error {
      color: #e13b2e;
      font-size: 0.9rem;
      margin-top: 5px;
      margin-left: 30px;
    }
    .success {
      color: #28a745;
      font-size: 1rem;
      margin-top: 10px;
      padding: 12px;
      background: #d4edda;
      border-radius: 8px;
      border: 1px solid #c3e6cb;
    }
    .form-error {
      color: #e13b2e;
      font-size: 1rem;
      margin-top: 10px;
      padding: 12px;
      background: #fef5f5;
      border-radius: 8px;
      border: 1px solid #f5c6cb;
    }
    .loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid #ffffff;
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s ease-in-out infinite;
      margin-right: 8px;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    @media (max-width: 700px) {
      .container {
        padding: 16px 4vw 22px 4vw;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Daily Task Submission</h1>
    <div class="instructions">
      Please complete the following checklist to report your daily progress. All fields are mandatory.
    </div>
    <form id="dailyTaskForm">
      <!-- Skool Queries Post + DM -->
      <div class="form-section">
        <div class="question-header">
          <label>Skool Queries Post + DM <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="skoolQueries" name="skoolQueries">
        </div>
        <div class="desc">Did you complete the Skool queries post and direct messages?</div>
        <div class="textarea-container show" id="skoolQueriesContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="skoolQueriesReason" maxlength="2000"></textarea>
          <div class="char-counter" id="skoolQueriesCount">0/2000</div>
        </div>
        <div class="error" id="skoolQueriesError"></div>
      </div>

      <!-- New Members Post -->
      <div class="form-section">
        <div class="question-header">
          <label>New Members Post <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="newMembersPostCheck" name="newMembersPostCheck">
        </div>
        <div class="desc">Did you post for new members?</div>
        <div id="newMembersRadioContainer" style="display:none;">
          <div class="radio-group" style="margin-top:7px;">
            <label>
              <input type="radio" name="newMembersType" value="Tuesday Training Post"> Tuesday Training Post
            </label>
            <label>
              <input type="radio" name="newMembersType" value="Normal Post"> Normal Post
            </label>
          </div>
        </div>
        <div class="textarea-container show" id="newMembersPostContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="newMembersPostReason" maxlength="2000"></textarea>
          <div class="char-counter" id="newMembersPostCount">0/2000</div>
        </div>
        <div class="error" id="newMembersPostError"></div>
      </div>

      <!-- New Members DM -->
      <div class="form-section">
        <div class="question-header">
          <label>New Members DM <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="newMembersDM" name="newMembersDM">
        </div>
        <div class="desc">Did you send direct messages to new members?</div>
        <div class="textarea-container show" id="newMembersDMContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="newMembersDMReason" maxlength="2000"></textarea>
          <div class="char-counter" id="newMembersDMCount">0/2000</div>
        </div>
        <div class="error" id="newMembersDMError"></div>
      </div>

      <!-- Churned or Cancelling DM -->
      <div class="form-section">
        <div class="question-header">
          <label>Churned or Cancelling DM <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="churnedDM" name="churnedDM">
        </div>
        <div class="desc">Did you send direct messages to churned or cancelling members?</div>
        <div class="textarea-container show" id="churnedDMContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="churnedDMReason" maxlength="2000"></textarea>
          <div class="char-counter" id="churnedDMCount">0/2000</div>
        </div>
        <div class="error" id="churnedDMError"></div>
      </div>

      <!-- Replies to Free Skool Members -->
      <div class="form-section">
        <div class="question-header">
          <label>Replies to Free Skool Members <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="repliesFree" name="repliesFree">
        </div>
        <div class="desc">Did you reply to free Skool members who responded to the automated message?</div>
        <div class="textarea-container show" id="repliesFreeContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="repliesFreeReason" maxlength="2000"></textarea>
          <div class="char-counter" id="repliesFreeCount">0/2000</div>
        </div>
        <div class="error" id="repliesFreeError"></div>
      </div>

      <!-- Make.com Community -->
      <div class="form-section">
        <div class="question-header">
          <label>Make.com Community <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="makeCommunity" name="makeCommunity">
        </div>
        <div class="desc">Did you engage with the Make.com community?</div>
        <div class="textarea-container show" id="makeCommunityContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="makeCommunityReason" maxlength="2000"></textarea>
          <div class="char-counter" id="makeCommunityCount">0/2000</div>
        </div>
        <div class="error" id="makeCommunityError"></div>
      </div>

      <!-- Make.com Blueprint -->
      <div class="form-section">
        <div class="question-header">
          <label>Make.com Blueprint <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="makeBlueprint" name="makeBlueprint">
        </div>
        <div class="desc">Did you work on the Make.com blueprint?</div>
        <div class="textarea-container show" id="makeBlueprintContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="makeBlueprintReason" maxlength="2000"></textarea>
          <div class="char-counter" id="makeBlueprintCount">0/2000</div>
        </div>
        <div class="error" id="makeBlueprintError"></div>
      </div>

      <!-- n8n Blueprint -->
      <div class="form-section">
        <div class="question-header">
          <label>n8n Blueprint <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="n8nBlueprint" name="n8nBlueprint">
        </div>
        <div class="desc">Did you work on the n8n blueprint?</div>
        <div class="textarea-container show" id="n8nBlueprintContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="n8nBlueprintReason" maxlength="2000"></textarea>
          <div class="char-counter" id="n8nBlueprintCount">0/2000</div>
        </div>
        <div class="error" id="n8nBlueprintError"></div>
      </div>

      <!-- Sync New Members in Management Board -->
      <div class="form-section">
        <div class="question-header">
          <label>Sync New Members in Management Board <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="syncManagementBoard" name="syncManagementBoard">
        </div>
        <div class="desc">Did you sync new members to the management board?</div>
        <div class="textarea-container show" id="syncManagementBoardContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="syncManagementBoardReason" maxlength="2000"></textarea>
          <div class="char-counter" id="syncManagementBoardCount">0/2000</div>
        </div>
        <div class="error" id="syncManagementBoardError"></div>
      </div>

      <!-- Video post in other groups -->
      <div class="form-section">
        <div class="question-header">
          <label>Video post in other groups including free <span style="color:#e13b2e">*</span></label>
          <input type="checkbox" id="videoPost" name="videoPost">
        </div>
        <div class="desc">Have you posted?</div>
        <div class="textarea-container show" id="videoPostContainer">
          <div class="desc" style="font-weight:400;">Please explain why:</div>
          <textarea name="videoPostExplanation" maxlength="2000"></textarea>
          <div class="char-counter" id="videoPostCount">0/2000</div>
        </div>
        <div class="error" id="videoPostError"></div>
      </div>
      
      <!-- Free skool engagement strategy -->
      <div class="form-section">
        <div class="question-header">
          <label>Free Skool Engagement Strategy</label>
          <input type="checkbox" id="freeSkoolEngagement" name="freeSkoolEngagement">
        </div>
        <div class="desc">Did you try or plan any new engagement strategy for the free Skool group?</div>
        <div class="textarea-container" id="freeSkoolEngagementContainer">
          <div class="desc" style="margin-top:12px;">Please explain or describe your strategy:</div>
          <textarea name="freeSkoolEngagementStrategy" maxlength="2000"></textarea>
          <div class="char-counter" id="freeSkoolEngagementCount">0/2000</div>
        </div>
      </div>
      
      <!-- Paid skool idea -->
      <div class="form-section">
        <div class="question-header">
          <label>Paid Skool Idea</label>
          <input type="checkbox" id="paidSkoolIdea" name="paidSkoolIdea">
        </div>
        <div class="desc">Do you have a new idea or initiative for the paid Skool community?</div>
        <div class="textarea-container" id="paidSkoolIdeaContainer">
          <div class="desc" style="margin-top:12px;">Please share your idea or plan:</div>
          <textarea name="paidSkoolIdeaDescription" maxlength="2000"></textarea>
          <div class="char-counter" id="paidSkoolIdeaCount">0/2000</div>
        </div>
      </div>

      <!-- Additional Notes -->
      <div class="form-section">
        <label style="font-weight: 600; color: #23272f; margin-bottom: 4px; display: block;">Additional Notes</label>
        <div class="desc">Please add any extra work or important updates you'd like to mention here:</div>
        <textarea name="additionalNotes" maxlength="2000"></textarea>
        <div class="char-counter" id="notesCount">0/2000</div>
      </div>

      <button type="submit">Submit</button>
      <div id="submitMessage"></div>
    </form>
  </div>

  <script>
    // Character counter function
    function updateCharCount(textarea, counterId) {
      document.getElementById(counterId).innerText = textarea.value.length + "/2000";
    }

    // Clear field errors when user starts typing
    function clearFieldError(fieldId) {
      const errorDiv = document.getElementById(fieldId + 'Error');
      const textarea = document.querySelector(`textarea[name="${fieldId}Reason"], textarea[name="${fieldId}Explanation"]`);
      if (errorDiv) errorDiv.textContent = '';
      if (textarea) textarea.classList.remove('error-field');
    }

    // Toggle textarea visibility for checkboxes (reverse logic for special cases)
    function toggleTextareaReverse(checkboxId, containerId) {
      const checkbox = document.getElementById(checkboxId);
      const container = document.getElementById(containerId);
      
      if (checkbox.checked) {
        container.classList.add('show');
      } else {
        container.classList.remove('show');
      }
    }

    // Toggle textarea visibility for checkboxes
    function toggleTextarea(checkboxId, containerId) {
      const checkbox = document.getElementById(checkboxId);
      const container = document.getElementById(containerId);
      
      clearFieldError(checkboxId);
      
      if (checkbox.checked) {
        container.classList.remove('show');
      } else {
        container.classList.add('show');
      }
    }

    // Special handling for New Members Post
    function toggleNewMembersPost() {
      const checkbox = document.getElementById('newMembersPostCheck');
      const radioContainer = document.getElementById('newMembersRadioContainer');
      const textareaContainer = document.getElementById('newMembersPostContainer');
      
      clearFieldError('newMembersPost');
      
      if (checkbox.checked) {
        radioContainer.style.display = 'block';
        textareaContainer.classList.remove('show');
      } else {
        radioContainer.style.display = 'none';
        textareaContainer.classList.add('show');
        // Clear radio selection
        const radios = document.querySelectorAll('input[name="newMembersType"]');
        radios.forEach(radio => radio.checked = false);
      }
    }

    // Special handling for Video Post (same as general toggleTextarea)
    function toggleVideoPost() {
      const checkbox = document.getElementById('videoPost');
      const container = document.getElementById('videoPostContainer');
      
      clearFieldError('videoPost');
      
      if (checkbox.checked) {
        container.classList.remove('show');
      } else {
        container.classList.add('show');
      }
    }

    // Initialize form state and add event listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Add event listeners for all checkboxes
      document.getElementById('skoolQueries').addEventListener('change', function() {
        toggleTextarea('skoolQueries', 'skoolQueriesContainer');
      });

      document.getElementById('newMembersPostCheck').addEventListener('change', toggleNewMembersPost);

      document.getElementById('newMembersDM').addEventListener('change', function() {
        toggleTextarea('newMembersDM', 'newMembersDMContainer');
      });

      document.getElementById('churnedDM').addEventListener('change', function() {
        toggleTextarea('churnedDM', 'churnedDMContainer');
      });

      document.getElementById('repliesFree').addEventListener('change', function() {
        toggleTextarea('repliesFree', 'repliesFreeContainer');
      });

      document.getElementById('makeCommunity').addEventListener('change', function() {
        toggleTextarea('makeCommunity', 'makeCommunityContainer');
      });

      document.getElementById('makeBlueprint').addEventListener('change', function() {
        toggleTextarea('makeBlueprint', 'makeBlueprintContainer');
      });

      document.getElementById('n8nBlueprint').addEventListener('change', function() {
        toggleTextarea('n8nBlueprint', 'n8nBlueprintContainer');
      });
      
      document.getElementById('syncManagementBoard').addEventListener('change', function() { // New field
        toggleTextarea('syncManagementBoard', 'syncManagementBoardContainer');
      });

      document.getElementById('videoPost').addEventListener('change', toggleVideoPost);

      // Reverse logic for these two
      document.getElementById('freeSkoolEngagement').addEventListener('change', function() {
        toggleTextareaReverse('freeSkoolEngagement', 'freeSkoolEngagementContainer');
      });

      document.getElementById('paidSkoolIdea').addEventListener('change', function() {
        toggleTextareaReverse('paidSkoolIdea', 'paidSkoolIdeaContainer');
      });

      // Add character counters to all textareas
      const textareas = document.querySelectorAll('textarea');
      textareas.forEach(textarea => {
        const counterId = textarea.parentElement.querySelector('.char-counter')?.id;
        if (counterId) {
          // Initialize count on load
          updateCharCount(textarea, counterId);
          textarea.addEventListener('input', function() {
            updateCharCount(this, counterId);
            this.classList.remove('error-field');
            // Clear associated error message
            const name = this.name;
            let errorId = '';
            if (name.includes('Reason')) {
              errorId = name.replace('Reason', '') + 'Error';
            } else if (name.includes('Explanation')) {
              errorId = name.replace('Explanation', '') + 'Error';
            } else if (name === 'freeSkoolEngagementStrategy') {
                errorId = 'freeSkoolEngagementError'; // No actual error div defined for these, but good practice
            } else if (name === 'paidSkoolIdeaDescription') {
                errorId = 'paidSkoolIdeaError'; // No actual error div defined for these
            }

            // For the new field, to clear its specific error if it had one (though not directly tied to its textarea name like others)
            if (name === 'syncManagementBoardReason') {
              errorId = 'syncManagementBoardError';
            }

            const errorDiv = document.getElementById(errorId);
            if (errorDiv) errorDiv.textContent = '';
          });
        }
      });
    });

    // Form validation and submission
    document.getElementById('dailyTaskForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Clear all previous errors
      document.querySelectorAll('.error').forEach(errorDiv => {
        errorDiv.textContent = '';
      });
      document.querySelectorAll('textarea').forEach(textarea => {
        textarea.classList.remove('error-field');
      });
      document.getElementById('submitMessage').innerHTML = '';
      
      let isValid = true;
      const errors = [];

      // Validate New Members Post
      const newMembersPostCheck = document.getElementById('newMembersPostCheck');
      const newMembersType = document.querySelector('input[name="newMembersType"]:checked');
      const newMembersPostReason = document.querySelector('textarea[name="newMembersPostReason"]');
      const newMembersPostError = document.getElementById('newMembersPostError');

      if (newMembersPostCheck.checked && !newMembersType) {
        isValid = false;
        newMembersPostError.textContent = 'Please select the type of post (Tuesday Training Post or Normal Post)';
      } else if (!newMembersPostCheck.checked && !newMembersPostReason.value.trim()) {
        isValid = false;
        newMembersPostError.textContent = 'Please explain why you didn\'t post for new members';
        newMembersPostReason.classList.add('error-field');
      }

      // Validate mandatory fields that require explanation when not checked
      const mandatoryFields = [
        { checkbox: 'skoolQueries', textarea: 'skoolQueriesReason', label: 'Skool Queries Post + DM', errorId: 'skoolQueriesError' },
        { checkbox: 'newMembersDM', textarea: 'newMembersDMReason', label: 'New Members DM', errorId: 'newMembersDMError' },
        { checkbox: 'churnedDM', textarea: 'churnedDMReason', label: 'Churned or Cancelling DM', errorId: 'churnedDMError' },
        { checkbox: 'repliesFree', textarea: 'repliesFreeReason', label: 'Replies to Free Skool Members', errorId: 'repliesFreeError' },
        { checkbox: 'makeCommunity', textarea: 'makeCommunityReason', label: 'Make.com Community', errorId: 'makeCommunityError' },
        { checkbox: 'makeBlueprint', textarea: 'makeBlueprintReason', label: 'Make.com Blueprint', errorId: 'makeBlueprintError' },
        { checkbox: 'n8nBlueprint', textarea: 'n8nBlueprintReason', label: 'n8n Blueprint', errorId: 'n8nBlueprintError' },
        { checkbox: 'syncManagementBoard', textarea: 'syncManagementBoardReason', label: 'Sync New Members in Management Board', errorId: 'syncManagementBoardError' } // New field
      ];

      mandatoryFields.forEach(field => {
        const checkbox = document.getElementById(field.checkbox);
        const textarea = document.querySelector(`textarea[name="${field.textarea}"]`);
        const errorDiv = document.getElementById(field.errorId);
        
        if (!checkbox.checked && !textarea.value.trim()) {
          isValid = false;
          errorDiv.textContent = `Please explain why you didn't complete this task`;
          textarea.classList.add('error-field');
        }
      });

      // Validate Video Post - only require explanation if not checked
      const videoPost = document.getElementById('videoPost');
      const videoPostExplanation = document.querySelector('textarea[name="videoPostExplanation"]');
      const videoPostError = document.getElementById('videoPostError');
      
      if (!videoPost.checked && !videoPostExplanation.value.trim()) {
        isValid = false;
        videoPostError.textContent = 'Please explain why you didn\'t post videos';
        videoPostExplanation.classList.add('error-field');
      }
      
      // Validate optional fields that require explanation IF CHECKED AND TEXTAREA IS EMPTY
      // Free Skool Engagement
      const freeSkoolEngagementCheck = document.getElementById('freeSkoolEngagement');
      const freeSkoolEngagementStrategy = document.querySelector('textarea[name="freeSkoolEngagementStrategy"]');
      // No specific error div for this, but could add one if needed for this logic.
      // For now, if checked, strategy is expected. If not, this is fine.
      // If we want to make it mandatory if checked:
      // if (freeSkoolEngagementCheck.checked && !freeSkoolEngagementStrategy.value.trim()) {
      //   isValid = false;
      //   // Add an error message display mechanism if desired
      //   freeSkoolEngagementStrategy.classList.add('error-field');
      // }


      // Paid Skool Idea
      const paidSkoolIdeaCheck = document.getElementById('paidSkoolIdea');
      const paidSkoolIdeaDescription = document.querySelector('textarea[name="paidSkoolIdeaDescription"]');
      // Similar to above, if checked, description is expected.
      // if (paidSkoolIdeaCheck.checked && !paidSkoolIdeaDescription.value.trim()) {
      //   isValid = false;
      //   // Add an error message display mechanism if desired
      //   paidSkoolIdeaDescription.classList.add('error-field');
      // }


      if (!isValid) {
        document.getElementById('submitMessage').innerHTML = '<div class="form-error">Please fix the errors above before submitting</div>';
        // Scroll to first error
        const firstError = document.querySelector('.error:not(:empty), .error-field');
        if (firstError) {
          firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        return;
      }

      // Collect form data and submit
      const formData = collectFormData();
      submitToWebhook(formData);
    });

    function collectFormData() {
      const data = {
        timestamp: new Date().toISOString(),
        tasks: {
          skoolQueries: {
            completed: document.getElementById('skoolQueries').checked,
            reason: document.querySelector('textarea[name="skoolQueriesReason"]').value || null
          },
          newMembersPost: {
            completed: document.getElementById('newMembersPostCheck').checked,
            type: document.querySelector('input[name="newMembersType"]:checked')?.value || null,
            reason: document.querySelector('textarea[name="newMembersPostReason"]').value || null
          },
          newMembersDM: {
            completed: document.getElementById('newMembersDM').checked,
            reason: document.querySelector('textarea[name="newMembersDMReason"]').value || null
          },
          churnedDM: {
            completed: document.getElementById('churnedDM').checked,
            reason: document.querySelector('textarea[name="churnedDMReason"]').value || null
          },
          repliesFree: {
            completed: document.getElementById('repliesFree').checked,
            reason: document.querySelector('textarea[name="repliesFreeReason"]').value || null
          },
          makeCommunity: {
            completed: document.getElementById('makeCommunity').checked,
            reason: document.querySelector('textarea[name="makeCommunityReason"]').value || null
          },
          makeBlueprint: {
            completed: document.getElementById('makeBlueprint').checked,
            reason: document.querySelector('textarea[name="makeBlueprintReason"]').value || null
          },
          n8nBlueprint: {
            completed: document.getElementById('n8nBlueprint').checked,
            reason: document.querySelector('textarea[name="n8nBlueprintReason"]').value || null
          },
          syncManagementBoard: { // New field
            completed: document.getElementById('syncManagementBoard').checked,
            reason: document.querySelector('textarea[name="syncManagementBoardReason"]').value || null
          },
          videoPost: {
            completed: document.getElementById('videoPost').checked,
            explanation: document.querySelector('textarea[name="videoPostExplanation"]').value
          },
          freeSkoolEngagement: {
            completed: document.getElementById('freeSkoolEngagement').checked,
            strategy: document.querySelector('textarea[name="freeSkoolEngagementStrategy"]').value || null
          },
          paidSkoolIdea: {
            completed: document.getElementById('paidSkoolIdea').checked,
            description: document.querySelector('textarea[name="paidSkoolIdeaDescription"]').value || null
          }
        },
        additionalNotes: document.querySelector('textarea[name="additionalNotes"]').value || null
      };

      return data;
    }

    async function submitToWebhook(formData) {
      const submitButton = document.querySelector('button[type="submit"]');
      const messageDiv = document.getElementById('submitMessage');
      
      // Replace with your actual webhook URL
      const webhookUrl = 'https://hook.eu1.make.com/ii87emkdx5dqfahvsj8v8mie7lwiwpfq'; // Replace with your actual webhook URL
      
      try {
        submitButton.disabled = true;
        submitButton.innerHTML = '<span class="loading"></span>Submitting...';
        
        const response = await fetch(webhookUrl, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(formData)
        });

        if (response.ok) {
          messageDiv.innerHTML = '<div class="success">✓ Form submitted successfully!</div>';
          document.getElementById('dailyTaskForm').reset();
          // Reset form to initial state visually
          // Textareas need to be re-hidden/shown based on reset checkboxes
          document.querySelectorAll('.form-section input[type="checkbox"]').forEach(cb => {
            cb.dispatchEvent(new Event('change')); // Trigger change to reset dependent visibility
          });
          // Also reset character counters
          document.querySelectorAll('textarea').forEach(textarea => {
            const counterId = textarea.parentElement.querySelector('.char-counter')?.id;
            if (counterId) {
              updateCharCount(textarea, counterId);
            }
          });
          // For New Members Post radios
          document.getElementById('newMembersRadioContainer').style.display = 'none';

        } else {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
      } catch (error) {
        console.error('Submission error:', error);
        messageDiv.innerHTML = '<div class="form-error">❌ Error submitting form. Please check your connection and try again.</div>';
      } finally {
        submitButton.disabled = false;
        submitButton.innerHTML = 'Submit';
      }
    }
  </script>
</body>
</html>
